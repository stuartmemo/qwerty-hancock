/* Qwerty Hancock 0.5.1 (c) 2012-18 Stuart Memo */

!function(){var e="undefined"==typeof global?this:this.window,t={},o=!1,n={},i={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",89:"G#l",90:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",59:"Eu",186:"Eu",222:"Fu",221:"F#u",220:"Gu"},r=function(e){return Math.floor((t.width-e)/e)},s=function(e){var t,o;return o=3===e.length?e.charAt(2):e.charAt(1),t=(t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"].indexOf(e.slice(0,-1)))<3?t+12+12*(o-1)+1:t+12*(o-1)+1,440*Math.pow(2,(t-49)/12)},l=function(e){null===e&&void 0!==typeof e||(e.style.backgroundColor=t.activeColour)},u=function(e){null!==e&&("white"===e.getAttribute("data-note-type")?e.style.backgroundColor=t.whiteKeyColour:e.style.backgroundColor=t.blackKeyColour)},a=function(e){var o,n=0,i=e.length,r=[];for(o=0;o<i;o++)if(t.startNote.charAt(0)===e[o]){n=o;break}for(o=0;o<i;o++)r[o]=o+n>i-1?e[o+n-i]:e[o+n];return r},c=function(e){var o,n,i,s;e.el.style.display="inline-block",e.el.style["-webkit-user-select"]="none","white"===e.colour?((s=e).el.style.backgroundColor=t.whiteKeyColour,s.el.style.border="1px solid "+t.borderColour,s.el.style.borderRight=0,s.el.style.height=t.height+"px",s.el.style.width=s.width+"px",s.el.style.borderRadius="0 0 5px 5px",s.noteNumber===v()-1&&(s.el.style.border="1px solid "+t.borderColour)):(o=e,n=r(v()),i=Math.floor(n/2),o.el.style.backgroundColor=t.blackKeyColour,o.el.style.border="1px solid "+t.borderColour,o.el.style.position="absolute",o.el.style.left=Math.floor((n+1)*(o.noteNumber+1)-i/2)+"px",o.el.style.width=i+"px",o.el.style.height=t.height/1.5+"px",o.el.style.borderRadius="0 0 3px 3px")},d=function(e,t){"li"==e.tagName.toLowerCase()&&(o=!0,l(e),t(e.title,s(e.title)))},y=function(e,t){"li"==e.tagName.toLowerCase()&&(o=!1,u(e),t(e.title,s(e.title)))},h=function(e,t){o&&(u(e),t(e.title,s(e.title)))},f=function(e){return e.el=document.createElement("li"),e.el.id=e.id,e.el.title=e.id,e.el.setAttribute("data-note-type",e.colour),c(e),e},v=function(){return 7*t.octaves},p=function(){var e,o,n,i,s={container:document.getElementById(t.id),el:document.createElement("ul"),whiteNotes:a(["C","D","E","F","G","A","B"]),notesWithSharps:a(["C","D","F","G","A"])};return s.keys=function(){var e,o,n=this,i=[],s=0,l=t.startOctave,u=v();for(e=0;e<u;e++)e%this.whiteNotes.length==0&&(s=0),bizarre_note_counter=this.whiteNotes[s],"C"===bizarre_note_counter&&0!==e&&l++,o=f({colour:"white",octave:l,width:r(u),id:this.whiteNotes[s]+l,noteNumber:e}),i.push(o.el),e!==u-1&&this.notesWithSharps.forEach(function(t,a){t===n.whiteNotes[s]&&(o=f({colour:"black",octave:l,width:r(u)/2,id:n.whiteNotes[s]+"#"+l,noteNumber:e}),i.push(o.el))}),s++;return i}.call(s),e=s.whiteNotes,t.keyPressOffset="C"===e[0]?0:1,(n=function(e){e.style.cursor="default",e.style.fontSize="0px",e.style.height=t.height+"px",e.style.padding=0,e.style.position="relative",e.style.listStyle="none",e.style.margin=0,e.style.width=t.width+"px",e.style["-webkit-user-select"]="none"})((o=s).container),n(o.el),(i=s).keys.forEach(function(e){i.el.appendChild(e)}),s.container.appendChild(s.el),s},k=function(e){return i[e].replace("l",parseInt(t.keyOctave,10)+t.keyPressOffset).replace("u",(parseInt(t.keyOctave,10)+t.keyPressOffset+1).toString())},g=function(e){return e.ctrlKey||e.metaKey||e.altKey},w=function(t){var r=this;e.addEventListener("keydown",function(e){var t,o,u;g(e)||(t=e,o=r.keyDown,t.keyCode in n||(n[t.keyCode]=!0,void 0===i[t.keyCode]||(o(u=k(t.keyCode),s(u)),l(document.getElementById(u)),0))||e.preventDefault())}),e.addEventListener("keyup",function(e){var t,o,l;g(e)||(t=e,o=r.keyUp,delete n[t.keyCode],void 0!==i[t.keyCode]&&(o(l=k(t.keyCode),s(l)),u(document.getElementById(l)),1)&&e.preventDefault())}),t.addEventListener("mousedown",function(e){d(e.target,r.keyDown)}),t.addEventListener("mouseup",function(e){y(e.target,r.keyUp)}),t.addEventListener("mouseover",function(e){var t,n;t=e.target,n=r.keyDown,o&&(l(t),n(t.title,s(t.title)))}),t.addEventListener("mouseout",function(e){h(e.target,r.keyUp)}),"ontouchstart"in document.documentElement&&(t.addEventListener("touchstart",function(e){d(e.target,r.keyDown)}),t.addEventListener("touchend",function(e){y(e.target,r.keyUp)}),t.addEventListener("touchleave",function(e){h(e.target,r.keyUp)}),t.addEventListener("touchcancel",function(e){h(e.target,r.keyUp)}))},C=function(e){this.version="0.5.1",this.keyDown=function(){},this.keyUp=function(){},this.setKeyOctave=function(e){},this.getKeyOctave=function(){},this.keyOctaveUp=function(){},this.keyOctaveDown=function(){},this.getKeyMap=function(){},this.setKeyMap=function(e){},function(e){var o;user_settings=e||{},t={id:user_settings.id||"keyboard",octaves:user_settings.octaves||3,width:user_settings.width,height:user_settings.height,startNote:user_settings.startNote||"A3",whiteKeyColour:user_settings.whiteKeyColour||"#fff",blackKeyColour:user_settings.blackKeyColour||"#000",activeColour:user_settings.activeColour||"yellow",borderColour:user_settings.borderColour||"#000",keyboardLayout:user_settings.keyboardLayout||"en"},o=document.getElementById(t.id),void 0===t.width&&(t.width=o.offsetWidth),void 0===t.height&&(t.height=o.offsetHeight),t.startOctave=parseInt(t.startNote.charAt(1),10),t.keyOctave=user_settings.keyOctave||t.startOctave,this.setKeyOctave=function(e){return t.keyOctave=e,t.keyOctave},this.getKeyOctave=function(){return t.keyOctave},this.keyOctaveUp=function(){return t.keyOctave++,t.keyOctave},this.keyOctaveDown=function(){return t.keyOctave--,t.keyOctave},this.getKeyMap=function(){return i},this.setKeyMap=function(e){return i=e},p(),w.call(this,o)}.call(this,e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports.QwertyHancock=C):this.QwertyHancock=C}();