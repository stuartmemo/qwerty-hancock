(function(y,G){y.qwertyHancock=function(c){var a=c.id||"keyboard",z=7*(c.octaves||3),A=c.width||600,p=c.height||150,l=c.startNote||"A3",g=l.charAt(1),w=c.whiteKeyColour||"#FFF",x=c.blackKeyColour||"#000",s=c.hoverColour||"#076cf0",t=A/z,C=c.blackKeyWidth||t/2,F=c.blackKeyHeight||p/3;c=c.keyboardLayout||"en";var D=new Raphael(a,A,p),u="CDEFGAB".split(""),E=["A","C","D","F","G"],f=0,v=l.charAt(0),l=g,m=!1,q,r,B={},d=[],h=[],n=[];document.getElementById(a).style.fontSize="0px";for(var e=function(a){var b;
b=3===a.length?a.charAt(2):a.charAt(1);a="A A# B C C# D D# E F F# G G#".split(" ").indexOf(a.slice(0,-1));return 440*Math.pow(2,((3>a?a+12+12*(b-1)+1:a+12*(b-1)+1)-49)/12)},a=0;7>a;a++)if(v===u[a]){keyOffset=a;break}for(a=0;7>a;a++)n[a]=6<a+keyOffset?u[a+keyOffset-7]:u[a+keyOffset];for(a=0;a<z;a++)0===a%u.length&&(f=0),v=n[f],"C"===v&&l++,d[a]=D.rect(t*a,0,t,p).attr({id:n[f],title:n[f]+(l-1),fill:w}).mousedown(function(){m=!0;this.attr({fill:s});q(this.attr("title"),e(this.attrs.title))}).mouseover(function(){m&&
(this.attr({fill:s}),q(this.attr("title"),e(this.attrs.title)))}).mouseup(function(){this.attr({fill:w});m=!1;r(this.attr("title"),e(this.attrs.title))}).mouseout(function(){m&&(this.attr({fill:w}),r(this.attr("title"),e(this.attrs.title)))}),f++;l=g;for(a=0;a<z;a++){0===a%u.length&&(f=0);for(p=0;p<E.length;p++)n[f]===E[p]&&(v=n[f]+"#","C#"===v&&l++,t*(a+1)<A&&(h[a]=D.rect(t*(a+1)-C/2,0,C,F).attr({id:n[f],title:n[f]+"#"+(l-1),fill:x}).mousedown(function(){m=!0;this.attr({fill:s});q(this.attr("title"),
e(this.attrs.title))}).mouseover(function(){m&&(this.attr({fill:s}),q(this.attr("title"),e(this.attrs.title)))}).mouseup(function(){this.attr({fill:x});m=!1;r(this.attr("title"),e(this.attrs.title))}).mouseout(function(){m&&(this.attr({fill:x}),r(this.attr("title"),e(this.attrs.title)))})));f++}if("en"==c)var k={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",89:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu",221:"F#u",220:"Gu"};else"de"==c&&(k=
{65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",90:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu",221:"F#u",220:"Gu"});y.onkeydown=function(a){if(!(a.keyCode in B)){B[a.keyCode]=!0;for(var b=0;b<d.length;b++)if("undefined"!==typeof k[a.keyCode]&&"undefined"!==typeof d[b]){var c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString());d[b].attrs.title===c&&(d[b].attr({fill:s}),q(d[b].attrs.title,e(d[b].attrs.title)))}for(b=0;b<h.length;b++)"undefined"!==
typeof k[a.keyCode]&&"undefined"!==typeof h[b]&&(c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString()),h[b].attrs.title===c&&(h[b].attr({fill:s}),q(c,e(c))))}};y.onkeyup=function(a){delete B[a.keyCode];for(var b=0;b<d.length;b++)if("undefined"!==typeof k[a.keyCode]&&"undefined"!==typeof d[b]){var c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString());d[b].attrs.title===c&&(d[b].attr({fill:w}),r(d[b].attrs.title,e(d[b].attrs.title)))}for(b=0;b<h.length;b++)"undefined"!==
typeof k[a.keyCode]&&"undefined"!==typeof h[b]&&(c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString()),h[b].attrs.title===c&&(h[b].attr({fill:x}),r(c,e(c))))};return{keyDown:function(a){q=a},keyUp:function(a){r=a}}}})(window);
